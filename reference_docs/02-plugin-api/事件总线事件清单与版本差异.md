# 事件总线事件清单与版本差异

- 适用版本：SiYuan `v3.5.7` / `petal v1.1.8`
- 官方仓库同步到：`siyuan-note/petal@main` + `siyuan-note/siyuan@master`
- 最后核对：2026-02-21
- 稳定性：stable（含历史事件）
- 权威来源：
  - <https://github.com/siyuan-note/petal/blob/main/siyuan.d.ts>
  - <https://github.com/siyuan-note/petal/blob/main/CHANGELOG.md>
  - <https://docs.siyuan-note.club/zh-Hans/reference/api/plugin/event-bus/>

## 1. 事件清单（按常见度整理）

|事件名|触发场景|最低版本|备注|
|---|---|---|---|
|`click-blockicon`|块菜单打开|2.9.0|块右键|
|`click-editorcontent`|编辑区点击|2.9.0|编辑器区域|
|`click-editortitleicon`|文档块菜单打开|2.9.0|标题区域|
|`click-flashcard-action`|点击闪卡选项|2.12.8|闪卡|
|`click-pdf`|PDF 注释菜单打开|2.9.0|附件|
|`destroy-protyle`|编辑器关闭|2.10.2|资源释放|
|`input-search`|搜索输入变化|2.9.6|搜索栏|
|`loaded-protyle-dynamic`|编辑器内容动态加载|2.10.2|异步加载|
|`loaded-protyle-static`|编辑器内容静态加载|2.10.12|首次渲染|
|`lock-screen`|锁屏|2.12.0|系统|
|`mobile-keyboard-hide`|移动端键盘隐藏|2.11.1|移动端|
|`mobile-keyboard-show`|移动端键盘显示|2.11.1|移动端|
|`open-menu-av`|属性视图菜单|2.9.4|数据库|
|`open-menu-blockref`|块引用菜单|2.9.4|引用|
|`open-menu-breadcrumbmore`|面包屑更多菜单|2.9.4|导航|
|`open-menu-content`|文本选中菜单|2.9.4|内容|
|`open-menu-doctree`|文档树菜单|2.10.9|文档树|
|`open-menu-fileannotationref`|附件引用菜单|2.9.4|附件|
|`open-menu-image`|图片菜单|2.9.4|图片|
|`open-menu-inbox`|云收集箱菜单|2.12.0|收集箱|
|`open-menu-link`|链接菜单|2.9.4|链接|
|`open-menu-tag`|标签菜单|2.9.4|标签|
|`open-noneditableblock`|非可编辑块打开|2.9.0|只读区|
|`open-siyuan-url-block`|打开 `siyuan://blocks/`|2.10.0|协议|
|`open-siyuan-url-plugin`|打开 `siyuan://plugins/`|2.10.0|协议|
|`paste`|粘贴|2.10.12|剪贴板|
|`switch-protyle`|编辑器切换|2.10.13|切换|
|`sync-start`|同步开始|2.11.1|同步|
|`sync-end`|同步结束|2.11.1|同步|
|`sync-fail`|同步失败|2.11.1|同步|
|`ws-main`|主通道消息|2.9.0|系统事件流|

## 2. 已移除或替代事件

|事件名|状态|替代方案|
|---|---|---|
|`loaded-protyle`|已移除|使用 `loaded-protyle-static` / `loaded-protyle-dynamic`|

## 3. 事件参数与类型

- 事件参数以 `IEventBusMap` 为准，定义在 `siyuan.d.ts`。
- 监听前先判断事件是否存在，低版本需降级处理。

## 4. 本章如何使用

- 先查事件名与最低版本，再确定是否需要兼容。
- 事件回调需成对 `on/off`，避免内存泄漏。
- 复杂逻辑放到事件处理之外，保持回调轻量。
