# 调试与发布流程

- 适用版本：SiYuan `v3.5.7`
- 最后核对：2026-02-21
- 稳定性：stable
- 权威来源：
  - <https://github.com/siyuan-note/plugin-sample>
  - <https://github.com/siyuan-note/plugin-sample-vite-svelte>
  - <https://github.com/siyuan-note/bazaar>

## 1. 本地调试

- 推荐使用开发模式构建（watch/hot reload）
- 控制台排查优先顺序：
  1. 浏览器 DevTools
  2. 思源内置开发者工具
  3. 构建终端日志

## 2. 发布前检查清单

- `plugin.json`：
  - `name` 正确且与仓库同名
  - `version` 已递增
  - `minAppVersion` 已更新
- 资源完整：
  - `index.js`
  - `index.css`
  - `plugin.json`
  - `icon.png`
  - `preview.png`
  - `README*.md`
  - `i18n/*`（如有）

## 3. 上架流程

1. `pnpm run build` 生成 `package.zip`
2. 创建 GitHub Release（Tag 与版本号一致）
3. 上传 `package.zip` 到 Release 附件
4. 首次发布：向 `siyuan-note/bazaar` 提交仓库索引 PR

## 4. 常见问题

### 集市不更新

- 通常是 `plugin.json.version` 未变更
- 或 Release 附件缺少 `package.zip`

### 启用失败

- 检查 `minAppVersion` 与当前思源版本
- 检查 `plugin.json` 的 `backends/frontends` 限制

## 5. 版本策略

- 修复：`patch`
- 小功能：`minor`
- 破坏性改动：`major`

## 6. 本章如何使用

- 每次发版前按第 2 节全量核对
- 发布失败时按第 4 节快速排查
- 大版本升级前先检查第 5 节策略与迁移文档

